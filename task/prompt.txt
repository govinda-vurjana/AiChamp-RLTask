You are a Machine Learning Engineer tasked with fixing a broken data preprocessing pipeline.

TASK: Write a correct `preprocess_data()` function that prepares a dataset for ML model training.

The function must:
1. Load a CSV dataset with mixed data types (numeric, categorical, boolean)
2. Handle missing values in all columns appropriately
3. Encode categorical variables to numeric format (use OneHotEncoder)
4. Normalize/standardize numerical features using StandardScaler
5. Split data into train/test sets (80/20 split) WITHOUT data leakage
6. Use stratified sampling to preserve target class distribution
7. Include input validation and error handling
8. Return clean data with NO missing or infinite values

CRITICAL REQUIREMENTS:
✓ NO DATA LEAKAGE: Fit scalers/encoders on training data only, then transform test data
✓ STRATIFIED SPLIT: Use stratify parameter in train_test_split
✓ ALL FEATURES NUMERIC: Convert all categorical variables (no text columns in output)
✓ NO MISSING VALUES: Handle NaN values before returning
✓ PROPER NORMALIZATION: Use StandardScaler for numeric features
✓ ERROR HANDLING: Add try-except blocks or input validation
✓ CORRECT SPLIT RATIO: 80% train, 20% test
✓ PRESERVE FEATURES: Don't drop categorical columns, encode them
✓ CLEAN OUTPUT: No NaN, no inf values in final X_train, X_test

AVAILABLE TOOLS:
- python_expression: Execute Python code and see output
- file_reader: Read files from the task directory
- submit_answer: Submit your corrected preprocessing function

IMPORTANT CODING GUIDELINES:
- Use df[col] = df[col].fillna(value) instead of inplace=True
- Use OneHotEncoder(sparse_output=False) for newer sklearn versions
- Use OneHotEncoder(drop='first') to avoid multicollinearity
- Always split data BEFORE any preprocessing to avoid data leakage

SUBMISSION FORMAT:
You MUST submit your solution using the submit_answer tool with your corrected preprocess_data() function.

Example:
submit_answer(answer="def preprocess_data(filepath, target_column, test_size=0.2, random_state=42):\n    # your code here\n    return X_train, X_test, y_train, y_test")

The function should successfully process the sample dataset and pass all validation checks.